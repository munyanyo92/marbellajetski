<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Your Adventure | Marbella JetSki</title>
    <meta name="description" content="Book jet ski hire, yacht charters & water sports in Marbella. Instant confirmation, secure payment, free cancellation. Open daily 11am-8pm.">
    <link rel="icon" type="image/png" href="https://marbellajetski.com/wp-content/uploads/2021/05/MJS_16_500x500-removebg-preview.png">
    <link rel="manifest" href="manifest.json">
    <meta property="og:title" content="Book Your Adventure | Marbella JetSki">
    <meta property="og:description" content="Book jet ski hire, yacht charters & water sports in Marbella. Secure payment, free 24h cancellation.">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://marbellajetski.com/wp-content/uploads/2021/05/MJS_16_500x500.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800;900&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="styles.css?v=2026020923">
    <style>
        /* ========== Booking Page Specific Styles ========== */
        .booking-page-hero {
            background: linear-gradient(135deg, #03045e 0%, #0077b6 50%, #00b4d8 100%);
            padding: 140px 0 80px;
            text-align: center;
            color: white;
        }
        .booking-page-hero h1 {
            font-family: var(--font-display);
            font-size: 3rem;
            margin-bottom: 15px;
        }
        .booking-page-hero p {
            font-size: 1.15rem;
            opacity: 0.85;
            max-width: 600px;
            margin: 0 auto;
        }

        .booking-main {
            padding: 60px 0 100px;
            background: #f8fbfe;
        }

        .booking-layout {
            display: grid;
            grid-template-columns: 1fr 380px;
            gap: 40px;
            align-items: start;
        }

        /* ========== Booking Steps ========== */
        .booking-steps {
            display: flex;
            gap: 0;
            margin-bottom: 40px;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 12px rgba(0,0,0,0.06);
        }
        .step {
            flex: 1;
            padding: 18px 20px;
            text-align: center;
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--gray-400);
            border-bottom: 3px solid transparent;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .step.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
            background: rgba(0, 180, 216, 0.04);
        }
        .step.completed {
            color: #10b981;
            border-bottom-color: #10b981;
        }
        .step-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: var(--gray-200);
            color: var(--gray-500);
            font-size: 0.8rem;
            margin-right: 8px;
        }
        .step.active .step-number {
            background: var(--primary);
            color: white;
        }
        .step.completed .step-number {
            background: #10b981;
            color: white;
        }

        /* ========== Step Panels ========== */
        .step-panel {
            display: none;
            background: white;
            border-radius: 16px;
            padding: 40px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.06);
        }
        .step-panel.active { display: block; }
        .step-panel h3 {
            font-size: 1.4rem;
            color: var(--dark);
            margin-bottom: 25px;
        }

        /* ========== Activity Selection ========== */
        .category-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        .cat-tab {
            padding: 10px 20px;
            border-radius: 50px;
            border: 2px solid var(--gray-200);
            background: white;
            font-weight: 600;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .cat-tab:hover, .cat-tab.active {
            border-color: var(--primary);
            background: rgba(0, 180, 216, 0.06);
            color: var(--primary);
        }

        .activity-options {
            display: grid;
            gap: 12px;
        }
        .activity-option {
            display: grid;
            grid-template-columns: auto 1fr auto auto;
            align-items: center;
            gap: 15px;
            padding: 18px 20px;
            border: 2px solid var(--gray-200);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .activity-option:hover {
            border-color: var(--primary-light);
            background: rgba(0, 180, 216, 0.02);
        }
        .activity-option.selected {
            border-color: var(--primary);
            background: rgba(0, 180, 216, 0.06);
            box-shadow: 0 0 0 1px var(--primary);
        }
        .activity-option input[type="radio"] {
            width: 20px;
            height: 20px;
            accent-color: var(--primary);
        }
        .activity-option .name {
            font-weight: 600;
            color: var(--dark);
        }
        .activity-option .duration {
            font-size: 0.85rem;
            color: var(--gray-500);
        }
        .activity-option .capacity {
            font-size: 0.8rem;
            color: var(--gray-400);
            background: var(--gray-100);
            padding: 4px 10px;
            border-radius: 20px;
        }
        .activity-option .price {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--primary-dark);
            white-space: nowrap;
        }

        /* ========== Form Fields ========== */
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .form-grid .full { grid-column: 1 / -1; }
        .field {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        .field label {
            font-weight: 600;
            font-size: 0.85rem;
            color: var(--gray-700);
        }
        .field input, .field select, .field textarea {
            padding: 14px 16px;
            border: 2px solid var(--gray-200);
            border-radius: 10px;
            font-size: 0.95rem;
            font-family: var(--font-primary);
            transition: border-color 0.3s ease;
        }
        .field input:focus, .field select:focus, .field textarea:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(0, 180, 216, 0.1);
        }

        /* ========== Date & Time Picker ========== */
        .datetime-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        .guests-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        /* ========== Payment Section ========== */
        .payment-methods {
            display: grid;
            gap: 12px;
            margin-bottom: 25px;
        }
        .payment-method {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 18px 20px;
            border: 2px solid var(--gray-200);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .payment-method:hover { border-color: var(--primary-light); }
        .payment-method.selected {
            border-color: var(--primary);
            background: rgba(0, 180, 216, 0.04);
        }
        .payment-method input[type="radio"] {
            width: 20px;
            height: 20px;
            accent-color: var(--primary);
        }
        .payment-method .method-info h5 {
            font-size: 0.95rem;
            margin-bottom: 3px;
        }
        .payment-method .method-info p {
            font-size: 0.82rem;
            color: var(--gray-500);
        }
        .payment-icons {
            margin-left: auto;
            display: flex;
            gap: 8px;
            font-size: 1.4rem;
            color: var(--gray-400);
        }

        .card-fields {
            display: none;
            background: var(--gray-100);
            border-radius: 12px;
            padding: 25px;
            margin-top: 15px;
        }
        .card-fields.visible { display: block; }
        .card-number-field {
            position: relative;
        }
        .card-number-field .card-brand {
            position: absolute;
            right: 14px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.3rem;
            color: var(--gray-400);
        }

        /* ========== Deposit Option ========== */
        .deposit-toggle {
            display: flex;
            gap: 12px;
            margin-bottom: 25px;
        }
        .deposit-option {
            flex: 1;
            padding: 18px 20px;
            border: 2px solid var(--gray-200);
            border-radius: 12px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s ease;
        }
        .deposit-option.selected {
            border-color: var(--primary);
            background: rgba(0, 180, 216, 0.05);
        }
        .deposit-option .amount {
            font-size: 1.4rem;
            font-weight: 800;
            color: var(--primary-dark);
        }
        .deposit-option .label {
            font-size: 0.82rem;
            color: var(--gray-500);
            margin-top: 4px;
        }

        /* ========== Terms Checkbox ========== */
        .terms-check {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin: 25px 0;
            padding: 18px;
            background: var(--gray-100);
            border-radius: 10px;
        }
        .terms-check input {
            width: 20px;
            height: 20px;
            margin-top: 2px;
            accent-color: var(--primary);
        }
        .terms-check label {
            font-size: 0.85rem;
            color: var(--gray-600);
            line-height: 1.6;
        }
        .terms-check a {
            color: var(--primary);
            text-decoration: underline;
        }

        /* ========== Navigation Buttons ========== */
        .step-nav {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            padding-top: 25px;
            border-top: 1px solid var(--gray-200);
        }
        .btn-back {
            padding: 14px 30px;
            border-radius: 50px;
            border: 2px solid var(--gray-300);
            background: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .btn-back:hover {
            border-color: var(--gray-400);
        }
        .btn-next {
            padding: 14px 35px;
            border-radius: 50px;
            border: none;
            background: var(--gradient-primary);
            color: white;
            font-weight: 700;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .btn-next:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 180, 216, 0.3);
        }

        /* ========== Order Summary Sidebar ========== */
        .order-summary {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.06);
            position: sticky;
            top: 100px;
        }
        .order-summary h4 {
            font-size: 1.1rem;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--gray-200);
        }
        .summary-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            font-size: 0.9rem;
        }
        .summary-row .label { color: var(--gray-500); }
        .summary-row .value { font-weight: 600; color: var(--dark); }
        .summary-divider {
            border-top: 1px solid var(--gray-200);
            margin: 10px 0;
        }
        .summary-total {
            display: flex;
            justify-content: space-between;
            padding: 15px 0;
            font-size: 1.15rem;
            font-weight: 800;
            color: var(--dark);
        }
        .summary-total .total-price {
            color: var(--primary-dark);
        }

        .summary-badges {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--gray-200);
        }
        .summary-badge {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.82rem;
            color: var(--gray-600);
        }
        .summary-badge i {
            color: #10b981;
            width: 18px;
        }

        .summary-whatsapp {
            display: block;
            text-align: center;
            margin-top: 20px;
            padding: 14px;
            background: #25d366;
            color: white;
            border-radius: 10px;
            font-weight: 600;
            font-size: 0.9rem;
            text-decoration: none;
            transition: all 0.3s ease;
        }
        .summary-whatsapp:hover {
            background: #1fb655;
            transform: translateY(-2px);
        }

        /* ========== Confirmation ========== */
        .confirmation {
            text-align: center;
            padding: 60px 40px;
        }
        .confirmation-icon {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #10b981, #34d399);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 25px;
            font-size: 2rem;
            color: white;
        }
        .confirmation h3 {
            font-size: 1.6rem;
            margin-bottom: 12px;
        }
        .confirmation p {
            color: var(--gray-500);
            max-width: 450px;
            margin: 0 auto 30px;
        }
        .booking-ref {
            background: var(--gray-100);
            border-radius: 10px;
            padding: 15px 25px;
            display: inline-block;
            margin-bottom: 30px;
        }
        .booking-ref .ref-label {
            font-size: 0.8rem;
            color: var(--gray-500);
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .booking-ref .ref-number {
            font-size: 1.3rem;
            font-weight: 800;
            color: var(--primary-dark);
        }

        /* ========== Policies Bar ========== */
        .policies-bar {
            background: white;
            padding: 30px 0;
            border-top: 1px solid var(--gray-200);
        }
        .policies-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 30px;
            text-align: center;
        }
        .policy-item i {
            font-size: 1.5rem;
            color: var(--primary);
            margin-bottom: 10px;
            display: block;
        }
        .policy-item h5 {
            font-size: 0.85rem;
            color: var(--dark);
            margin-bottom: 4px;
        }
        .policy-item p {
            font-size: 0.78rem;
            color: var(--gray-500);
        }

        @media (max-width: 992px) {
            .booking-layout { grid-template-columns: 1fr; }
            .booking-steps { flex-wrap: wrap; }
            .step { font-size: 0.8rem; }
            .form-grid { grid-template-columns: 1fr; }
            .policies-grid { grid-template-columns: repeat(2, 1fr); }
        }
        @media (max-width: 576px) {
            .step-panel { padding: 25px 20px; }
            .booking-page-hero h1 { font-size: 2rem; }
            .datetime-grid, .guests-grid { grid-template-columns: 1fr; }
            .deposit-toggle { flex-direction: column; }
            .policies-grid { grid-template-columns: 1fr; }
        }
        .validation-msg { background: #fef3c7; border: 1px solid #f59e0b; border-radius: 10px; padding: 14px 18px; margin: 15px 0; font-size: 0.88rem; color: #92400e; display: none; align-items: center; gap: 10px; }
        .validation-msg i { color: #f59e0b; font-size: 1.1rem; }
        .validation-msg.visible { display: flex; }
    </style>
</head>
<body>
    <a href="#main-content" class="skip-link">Skip to content</a>
    <!-- Navigation -->
    <nav class="navbar scrolled" id="navbar">
        <div class="nav-container">
            <a href="index.html" class="nav-logo">
                <img src="https://marbellajetski.com/wp-content/uploads/2021/05/MJS_16_500x500-removebg-preview.png" alt="Marbella JetSki Logo" class="logo-image" style="height: 45px;">
                <span class="logo-text">MARBELLA<span class="logo-highlight">JETSKI</span></span>
            </a>
            <div class="nav-menu" id="navMenu">
                <a href="index.html" class="nav-link">Home</a>
                <a href="index.html#services" class="nav-link">Services</a>
                <a href="index.html#jetski" class="nav-link">Jet Ski</a>
                <a href="index.html#watersports" class="nav-link">Water Sports</a>
                <a href="index.html#boats" class="nav-link">Yachts</a>
                <a href="about-daniel.html" class="nav-link">Lessons</a>
                <a href="index.html#contact" class="nav-link">Contact</a>
            </div>
            <div class="nav-actions">
                <a href="booking.html" class="nav-cta active">
                    <span>Book Now</span>
                    <i class="fas fa-calendar-check"></i>
                </a>
            </div>
            <button class="nav-toggle" id="navToggle" aria-label="Toggle navigation">
                <span></span><span></span><span></span>
            </button>
        </div>
    </nav>

    <main id="main-content">
    <!-- Hero -->
    <section class="booking-page-hero">
        <div class="container">
            <h1>Book Your <span class="gradient-text-animated">Adventure</span></h1>
            <p>Select your activity, choose a date, and secure your spot in minutes. Open daily 11am – 8pm.</p>
        </div>
    </section>

    <!-- Booking Main -->
    <section class="booking-main">
        <div class="container">
            <!-- Steps Indicator -->
            <div class="booking-steps">
                <div class="step active" data-step="1">
                    <span class="step-number">1</span> Choose Activity
                </div>
                <div class="step" data-step="2">
                    <span class="step-number">2</span> Date & Details
                </div>
                <div class="step" data-step="3">
                    <span class="step-number">3</span> Your Info
                </div>
                <div class="step" data-step="4">
                    <span class="step-number">4</span> Payment
                </div>
            </div>

            <div class="booking-layout">
                <div class="booking-form-area">
                    <!-- STEP 1: Choose Activity -->
                    <div class="step-panel active" id="step1">
                        <h3><i class="fas fa-water"></i> Choose Your Activity</h3>
                        
                        <div class="category-tabs">
                            <button class="cat-tab active" data-cat="all">All</button>
                            <button class="cat-tab" data-cat="jetski">Jet Ski</button>
                            <button class="cat-tab" data-cat="watersports">Water Sports</button>
                            <button class="cat-tab" data-cat="yacht">Yacht Charters</button>
                            <button class="cat-tab" data-cat="training" style="border-color:var(--accent-gold);color:var(--accent-gold);"><i class="fas fa-trophy"></i> With Daniel</button>
                        </div>

                        <div class="activity-options" id="activityList">
                            <!-- Jet Ski -->
                            <label class="activity-option" data-cat="jetski">
                                <input type="radio" name="activity" value="jetski-circuit-20" data-price="70" data-name="Jet Ski Circuit" data-duration="20 min" data-type="circuit">
                                <div>
                                    <div class="name">Jet Ski Circuit</div>
                                    <div class="duration">20 minutes</div>
                                </div>
                                <span class="capacity"><i class="fas fa-user"></i> 1-2</span>
                                <span class="price">€70</span>
                            </label>
                            <label class="activity-option" data-cat="jetski">
                                <input type="radio" name="activity" value="jetski-circuit-30" data-price="90" data-name="Jet Ski Circuit" data-duration="30 min" data-type="circuit">
                                <div>
                                    <div class="name">Jet Ski Circuit</div>
                                    <div class="duration">30 minutes</div>
                                </div>
                                <span class="capacity"><i class="fas fa-user"></i> 1-2</span>
                                <span class="price">€90</span>
                            </label>
                            <label class="activity-option" data-cat="jetski">
                                <input type="radio" name="activity" value="jetski-circuit-60" data-price="170" data-name="Jet Ski Circuit" data-duration="1 hour" data-type="circuit">
                                <div>
                                    <div class="name">Jet Ski Circuit <span style="color:var(--secondary);font-size:0.75rem;font-weight:700;">POPULAR</span></div>
                                    <div class="duration">1 hour</div>
                                </div>
                                <span class="capacity"><i class="fas fa-user"></i> 1-2</span>
                                <span class="price">€170</span>
                            </label>
                            <label class="activity-option" data-cat="jetski">
                                <input type="radio" name="activity" value="jetski-circuit-120" data-price="330" data-name="Jet Ski Circuit" data-duration="2 hours" data-type="circuit">
                                <div>
                                    <div class="name">Jet Ski Circuit</div>
                                    <div class="duration">2 hours</div>
                                </div>
                                <span class="capacity"><i class="fas fa-user"></i> 1-2</span>
                                <span class="price">€330</span>
                            </label>
                            <label class="activity-option" data-cat="jetski">
                                <input type="radio" name="activity" value="jetski-excursion-60" data-price="170" data-name="Jet Ski Excursion" data-duration="1 hour" data-type="tour">
                                <div>
                                    <div class="name">Jet Ski Excursion</div>
                                    <div class="duration">1 hour — Puerto Banús / Fuengirola / Coastal Tour</div>
                                </div>
                                <span class="capacity"><i class="fas fa-user"></i> 1-2</span>
                                <span class="price">€170</span>
                            </label>

                            <!-- Water Sports -->
                            <label class="activity-option" data-cat="watersports">
                                <input type="radio" name="activity" value="wakeboard" data-price="90" data-name="Wakeboarding" data-duration="20 min" data-per="ride">
                                <div>
                                    <div class="name">Wakeboarding</div>
                                    <div class="duration">20 minutes</div>
                                </div>
                                <span class="capacity"><i class="fas fa-user"></i> 1</span>
                                <span class="price">€90</span>
                            </label>
                            <label class="activity-option" data-cat="watersports">
                                <input type="radio" name="activity" value="waterski" data-price="90" data-name="Water Skiing" data-duration="20 min" data-per="ride">
                                <div>
                                    <div class="name">Water Skiing</div>
                                    <div class="duration">20 minutes</div>
                                </div>
                                <span class="capacity"><i class="fas fa-user"></i> 1</span>
                                <span class="price">€90</span>
                            </label>
                            <label class="activity-option" data-cat="watersports">
                                <input type="radio" name="activity" value="banana" data-price="20" data-name="Banana Boat" data-duration="10 min" data-per="person" data-type="towable">
                                <div>
                                    <div class="name">Banana Boat</div>
                                    <div class="duration">10 min · €20/person · Min. 2 people</div>
                                </div>
                                <span class="capacity"><i class="fas fa-users"></i> 2-8</span>
                                <span class="price">€20<small>/pp</small></span>
                            </label>
                            <label class="activity-option" data-cat="watersports">
                                <input type="radio" name="activity" value="sofa" data-price="20" data-name="Crazy Sofa" data-duration="10 min" data-per="person" data-type="towable">
                                <div>
                                    <div class="name">Crazy Sofa</div>
                                    <div class="duration">10 min · €20/person · Min. 2 people</div>
                                </div>
                                <span class="capacity"><i class="fas fa-users"></i> 2-6</span>
                                <span class="price">€20<small>/pp</small></span>
                            </label>
                            <label class="activity-option" data-cat="watersports">
                                <input type="radio" name="activity" value="waterbull" data-price="20" data-name="Water Bull" data-duration="10 min" data-per="person" data-type="towable">
                                <div>
                                    <div class="name">Water Bull</div>
                                    <div class="duration">10 min · €20/person · Min. 2 people</div>
                                </div>
                                <span class="capacity"><i class="fas fa-users"></i> 2-6</span>
                                <span class="price">€20<small>/pp</small></span>
                            </label>
                            <label class="activity-option" data-cat="watersports">
                                <input type="radio" name="activity" value="airstream" data-price="20" data-name="Air Stream" data-duration="10 min" data-per="person" data-type="towable">
                                <div>
                                    <div class="name">Air Stream</div>
                                    <div class="duration">10 min · €20/person · Min. 2 people</div>
                                </div>
                                <span class="capacity"><i class="fas fa-users"></i> 2-6</span>
                                <span class="price">€20<small>/pp</small></span>
                            </label>
                            <label class="activity-option" data-cat="watersports">
                                <input type="radio" name="activity" value="donut" data-price="20" data-name="Donut Ride" data-duration="10 min" data-per="person" data-type="towable">
                                <div>
                                    <div class="name">Donut Ride</div>
                                    <div class="duration">10 min · €20/person · Min. 2 people</div>
                                </div>
                                <span class="capacity"><i class="fas fa-users"></i> 2-6</span>
                                <span class="price">€20<small>/pp</small></span>
                            </label>
                            <label class="activity-option" data-cat="watersports">
                                <input type="radio" name="activity" value="sup" data-price="25" data-name="Stand-Up Paddleboarding" data-duration="1 hour" data-type="sup">
                                <div>
                                    <div class="name">Stand-Up Paddleboarding (SUP) <span style="font-size:0.75rem;color:var(--gray-500);">Individual</span></div>
                                    <div class="duration">1 hour · Individual activity (1 person per board)</div>
                                </div>
                                <span class="capacity"><i class="fas fa-user"></i> 1</span>
                                <span class="price">€25</span>
                            </label>
                            <label class="activity-option" data-cat="watersports">
                                <input type="radio" name="activity" value="pedal" data-price="30" data-name="Pedal Boat with Slide" data-duration="1 hour">
                                <div>
                                    <div class="name">Pedal Boat (Hydro-Pedal with Slide)</div>
                                    <div class="duration">1 hour · Family friendly!</div>
                                </div>
                                <span class="capacity"><i class="fas fa-users"></i> Up to 6</span>
                                <span class="price">€30</span>
                            </label>

                            <!-- Yacht Charters -->
                            <label class="activity-option" data-cat="yacht">
                                <input type="radio" name="activity" value="yacht-1h" data-price="400" data-name="Yacht Charter" data-duration="1 hour">
                                <div>
                                    <div class="name">Yacht Charter — 1 Hour</div>
                                    <div class="duration">Captain, fuel, drinks, paddleboard included</div>
                                </div>
                                <span class="capacity"><i class="fas fa-users"></i> Up to 12</span>
                                <span class="price">€400</span>
                            </label>
                            <label class="activity-option" data-cat="yacht">
                                <input type="radio" name="activity" value="yacht-2h" data-price="600" data-name="Yacht Charter" data-duration="2 hours">
                                <div>
                                    <div class="name">Yacht Charter — 2 Hours</div>
                                    <div class="duration">Captain, fuel, drinks, paddleboard included</div>
                                </div>
                                <span class="capacity"><i class="fas fa-users"></i> Up to 12</span>
                                <span class="price">€600</span>
                            </label>
                            <label class="activity-option" data-cat="yacht">
                                <input type="radio" name="activity" value="yacht-3h" data-price="800" data-name="Yacht Charter" data-duration="3 hours">
                                <div>
                                    <div class="name">Yacht Charter — 3 Hours</div>
                                    <div class="duration">Captain, fuel, drinks, paddleboard included</div>
                                </div>
                                <span class="capacity"><i class="fas fa-users"></i> Up to 12</span>
                                <span class="price">€800</span>
                            </label>
                            <label class="activity-option" data-cat="yacht">
                                <input type="radio" name="activity" value="yacht-4h" data-price="1000" data-name="Yacht Charter" data-duration="4 hours">
                                <div>
                                    <div class="name">Yacht Charter — 4 Hours <span style="color:var(--secondary);font-size:0.75rem;font-weight:700;">BEST VALUE</span></div>
                                    <div class="duration">Captain, fuel, drinks, paddleboard included</div>
                                </div>
                                <span class="capacity"><i class="fas fa-users"></i> Up to 12</span>
                                <span class="price">€1,000</span>
                            </label>
                            <label class="activity-option" data-cat="yacht">
                                <input type="radio" name="activity" value="yacht-6h" data-price="1500" data-name="Yacht Charter" data-duration="6 hours">
                                <div>
                                    <div class="name">Yacht Charter — 6 Hours</div>
                                    <div class="duration">Captain, fuel, drinks, paddleboard included</div>
                                </div>
                                <span class="capacity"><i class="fas fa-users"></i> Up to 12</span>
                                <span class="price">€1,500</span>
                            </label>
                            <label class="activity-option" data-cat="yacht">
                                <input type="radio" name="activity" value="yacht-8h" data-price="1800" data-name="Yacht Charter" data-duration="Full day">
                                <div>
                                    <div class="name">Yacht Charter — Full Day (8h)</div>
                                    <div class="duration">Captain, fuel, drinks, paddleboard included</div>
                                </div>
                                <span class="capacity"><i class="fas fa-users"></i> Up to 12</span>
                                <span class="price">€1,800</span>
                            </label>

                            <!-- Training with Daniel (request-only) -->
                            <div style="padding:16px 0 8px;border-top:2px solid var(--gray-200);margin-top:12px;">
                                <span style="font-weight:700;font-size:0.85rem;color:var(--primary);text-transform:uppercase;letter-spacing:1px;"><i class="fas fa-trophy"></i> Train with the Champion</span>
                            </div>
                            <label class="activity-option" data-cat="training" style="border-left:3px solid var(--accent-gold);">
                                <input type="radio" name="activity" value="training-daniel" data-price="0" data-name="Training with Daniel" data-duration="Subject to confirmation" data-type="request-only">
                                <div>
                                    <div class="name">Training with Daniel <span style="background:var(--accent-gold);color:#000;font-size:0.7rem;padding:2px 8px;border-radius:10px;font-weight:700;">BY REQUEST</span></div>
                                    <div class="duration">Mornings only (10:00–14:00) · Personal coaching with 4x National Champion</div>
                                </div>
                                <span class="capacity"><i class="fas fa-user"></i> 1-2</span>
                                <span class="price" style="color:var(--accent-gold);">Contact us</span>
                            </label>
                            <label class="activity-option" data-cat="training" style="border-left:3px solid var(--accent-gold);">
                                <input type="radio" name="activity" value="racing-daniel" data-price="0" data-name="Racing Experience with Daniel" data-duration="Subject to confirmation" data-type="request-only">
                                <div>
                                    <div class="name">Racing Experience <span style="background:var(--accent-gold);color:#000;font-size:0.7rem;padding:2px 8px;border-radius:10px;font-weight:700;">BY REQUEST</span></div>
                                    <div class="duration">Mornings only (10:00–14:00) · Timed circuit set up by Daniel to test your skills</div>
                                </div>
                                <span class="capacity"><i class="fas fa-user"></i> 1-2</span>
                                <span class="price" style="color:var(--accent-gold);">Contact us</span>
                            </label>
                        </div>

                        <!-- Request-only notice for Training/Racing -->
                        <div id="trainingNotice" style="display:none;background:linear-gradient(135deg,#fef3c7,#fde68a);border:2px solid var(--accent-gold);border-radius:12px;padding:20px;margin-top:16px;">
                            <h4 style="color:#92400e;margin-bottom:8px;"><i class="fas fa-info-circle"></i> Availability Request Only</h4>
                            <p style="color:#78350f;font-size:0.9rem;margin-bottom:12px;">Training sessions with Daniel cannot be booked directly online. Please contact us to check availability. Sessions are only available mornings (10:00–14:00).</p>
                            <div style="display:flex;gap:12px;flex-wrap:wrap;">
                                <a href="https://api.whatsapp.com/send?phone=34655442232&text=Hi%20Daniel!%20I'm%20interested%20in%20a%20personal%20training%2Fracing%20session.%20Could%20you%20let%20me%20know%20your%20availability%3F" target="_blank" rel="noopener noreferrer" style="display:inline-flex;align-items:center;gap:8px;background:#25D366;color:white;padding:12px 20px;border-radius:50px;font-weight:600;text-decoration:none;font-size:0.9rem;"><i class="fab fa-whatsapp"></i> WhatsApp Daniel</a>
                                <a href="tel:+34655442232" style="display:inline-flex;align-items:center;gap:8px;background:var(--primary);color:white;padding:12px 20px;border-radius:50px;font-weight:600;text-decoration:none;font-size:0.9rem;"><i class="fas fa-phone-alt"></i> +34 655 442 232</a>
                            </div>
                        </div>

                        <div class="step-nav">
                            <div></div>
                            <button class="btn-next" onclick="goToStep(2)">Continue <i class="fas fa-arrow-right"></i></button>
                        </div>
                    </div>

                    <!-- STEP 2: Date & Details -->
                    <div class="step-panel" id="step2">
                        <h3><i class="fas fa-calendar-alt"></i> Choose Date & Details</h3>
                        
                        <div id="sameDayMsg" class="validation-msg">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span>Same-day bookings are only available until 14:00. For last-minute bookings, contact us via <a href="https://api.whatsapp.com/send?phone=34655442232&text=Hi!%20I'd%20like%20to%20book%20for%20today" target="_blank" rel="noopener noreferrer" style="color:#92400e;font-weight:700;">WhatsApp</a> or call <a href="tel:+34655442232" style="color:#92400e;font-weight:700;">+34 655 442 232</a>.</span>
                        </div>

                        <div id="maxJetskiMsg" class="validation-msg">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span>Maximum 4 jet skis at the same time in circuit. For larger groups, please contact us.</span>
                        </div>

                        <div id="minTourMsg" class="validation-msg">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span>Excursions/tours require a minimum of 2 jet skis.</span>
                        </div>

                        <div id="minTowableMsg" class="validation-msg">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span>Towable activities (banana, sofa, donut...) require a minimum of 2 participants.</span>
                        </div>

                        <div class="datetime-grid">
                            <div class="field">
                                <label for="bookDate">Preferred Date *</label>
                                <input type="date" id="bookDate" required min="">
                            </div>
                            <div class="field">
                                <label for="bookTime">Preferred Time *</label>
                                <select id="bookTime" required>
                                    <option value="">Select time...</option>
                                    <option value="10:00">10:00</option>
                                    <option value="10:30">10:30</option>
                                    <option value="11:00">11:00</option>
                                    <option value="11:30">11:30</option>
                                    <option value="12:00">12:00</option>
                                    <option value="12:30">12:30</option>
                                    <option value="13:00">13:00</option>
                                    <option value="13:30">13:30</option>
                                    <option value="14:00">14:00</option>
                                </select>
                            </div>
                        </div>

                        <div class="guests-grid">
                            <div class="field">
                                <label for="bookGuests">Number of Guests *</label>
                                <input type="number" id="bookGuests" min="1" max="12" value="1">
                            </div>
                            <div class="field" id="jetskiCountField">
                                <label for="bookJetskis">Number of Jet Skis</label>
                                <input type="number" id="bookJetskis" min="1" max="4" value="1">
                            </div>
                        </div>

                        <div class="field" style="margin-top: 20px;">
                            <label for="bookNotes">Special Requests (optional)</label>
                            <textarea id="bookNotes" rows="3" placeholder="Birthday celebration, specific boat preference, accessibility needs..."></textarea>
                        </div>

                        <div class="step-nav">
                            <button class="btn-back" onclick="goToStep(1)"><i class="fas fa-arrow-left"></i> Back</button>
                            <button class="btn-next" onclick="goToStep(3)">Continue <i class="fas fa-arrow-right"></i></button>
                        </div>
                    </div>

                    <!-- STEP 3: Your Information -->
                    <div class="step-panel" id="step3">
                        <h3><i class="fas fa-user"></i> Your Information</h3>
                        
                        <div class="form-grid">
                            <div class="field">
                                <label for="bookFirstName">First Name *</label>
                                <input type="text" id="bookFirstName" required placeholder="e.g. John">
                            </div>
                            <div class="field">
                                <label for="bookLastName">Last Name *</label>
                                <input type="text" id="bookLastName" required placeholder="e.g. Smith">
                            </div>
                            <div class="field">
                                <label for="bookEmail">Email Address *</label>
                                <input type="email" id="bookEmail" required placeholder="john@example.com">
                            </div>
                            <div class="field">
                                <label for="bookPhone">Phone Number *</label>
                                <input type="tel" id="bookPhone" required placeholder="+34 XXX XXX XXX">
                            </div>
                            <div class="field">
                                <label for="bookID">ID/Passport Number *</label>
                                <input type="text" id="bookID" required placeholder="Required for contract">
                            </div>
                            <div class="field">
                                <label for="bookDOB">Date of Birth *</label>
                                <input type="date" id="bookDOB" required>
                            </div>
                            <div class="field full">
                                <label for="bookAddress">Address in Spain (if applicable)</label>
                                <input type="text" id="bookAddress" placeholder="Hotel name or address">
                            </div>
                        </div>

                        <div class="step-nav">
                            <button class="btn-back" onclick="goToStep(2)"><i class="fas fa-arrow-left"></i> Back</button>
                            <button class="btn-next" onclick="goToStep(4)">Continue to Payment <i class="fas fa-arrow-right"></i></button>
                        </div>
                    </div>

                    <!-- STEP 4: Payment -->
                    <div class="step-panel" id="step4">
                        <h3><i class="fas fa-lock"></i> Secure Payment</h3>

                        <h4 style="font-size:0.95rem;margin-bottom:15px;color:var(--gray-700);">Payment Amount</h4>
                        <div class="deposit-toggle">
                            <div class="deposit-option selected" onclick="selectDeposit('deposit', event)">
                                <div class="amount" id="depositAmount">€0</div>
                                <div class="label">30% Deposit — Pay rest on arrival</div>
                            </div>
                            <div class="deposit-option" onclick="selectDeposit('full', event)">
                                <div class="amount" id="fullAmount">€0</div>
                                <div class="label">Full Payment — No balance due</div>
                            </div>
                        </div>

                        <h4 style="font-size:0.95rem;margin-bottom:15px;color:var(--gray-700);">Payment Method</h4>
                        <div class="payment-methods">
                            <label class="payment-method selected" onclick="selectPayment('card', event)">
                                <input type="radio" name="payment" value="card" checked>
                                <div class="method-info">
                                    <h5>Credit / Debit Card</h5>
                                    <p>Visa, Mastercard, Amex</p>
                                </div>
                                <div class="payment-icons">
                                    <i class="fab fa-cc-visa"></i>
                                    <i class="fab fa-cc-mastercard"></i>
                                    <i class="fab fa-cc-amex"></i>
                                </div>
                            </label>
                            <label class="payment-method" onclick="selectPayment('paypal', event)">
                                <input type="radio" name="payment" value="paypal">
                                <div class="method-info">
                                    <h5>PayPal</h5>
                                    <p>Secure checkout via PayPal</p>
                                </div>
                                <div class="payment-icons">
                                    <i class="fab fa-paypal"></i>
                                </div>
                            </label>
                            <label class="payment-method" onclick="selectPayment('onsite', event)">
                                <input type="radio" name="payment" value="onsite">
                                <div class="method-info">
                                    <h5>Pay on Arrival</h5>
                                    <p>Cash or card at our beach location</p>
                                </div>
                                <div class="payment-icons">
                                    <i class="fas fa-money-bill-wave"></i>
                                </div>
                            </label>
                        </div>

                        <div class="card-fields visible" id="cardFields">
                            <div style="text-align:center; padding: 20px; background: rgba(0,180,216,0.06); border-radius: 12px; border: 1px dashed rgba(0,180,216,0.3);">
                                <i class="fas fa-lock" style="font-size: 2rem; color: var(--primary); margin-bottom: 10px;"></i>
                                <p style="margin:0; font-weight: 600; color: var(--dark);">Secure Payment Link</p>
                                <p style="margin: 8px 0 0; font-size: 0.85rem; color: var(--gray-500);">After confirming your booking, you'll receive a secure payment link via WhatsApp or email to complete your payment.</p>
                            </div>
                        </div>

                        <div class="terms-check">
                            <input type="checkbox" id="termsAccept" required>
                            <label for="termsAccept">
                                I have read and accept the <a href="terms.html" target="_blank" rel="noopener noreferrer">Terms & Conditions</a>, 
                                <a href="terms.html#privacy" target="_blank" rel="noopener noreferrer">Privacy Policy</a>, and 
                                <a href="terms.html#cancellation" target="_blank" rel="noopener noreferrer">Cancellation Policy</a>. 
                                I confirm I am at least 18 years old (or 16 with parental consent for jet ski activities). 
                                I accept the <a href="https://marbellajetski.com/contratos/rules-and-regulation/" target="_blank" rel="noopener noreferrer">Rules & Regulations</a> and <a href="weather-policy.html" target="_blank" rel="noopener noreferrer">Weather Cancellation Protocol</a> of Marbella JetSki.
                            </label>
                        </div>

                        <div class="terms-check" style="background: rgba(0,180,216,0.05);">
                            <input type="checkbox" id="mediaConsent">
                            <label for="mediaConsent">
                                I authorize Marbella JetSki to capture and publish photographic and audiovisual material of my experience for promotional purposes (optional).
                            </label>
                        </div>

                        <div class="step-nav">
                            <button class="btn-back" onclick="goToStep(3)"><i class="fas fa-arrow-left"></i> Back</button>
                            <button class="btn-next" onclick="submitBooking()" style="background: linear-gradient(135deg, #10b981, #059669);">
                                <i class="fas fa-lock"></i> Confirm & Pay <span id="payButtonAmount"></span>
                            </button>
                        </div>
                    </div>

                    <!-- STEP 5: Confirmation -->
                    <div class="step-panel" id="step5">
                        <div class="confirmation">
                            <div class="confirmation-icon"><i class="fas fa-check"></i></div>
                            <h3>Booking Confirmed!</h3>
                            <p>Thank you! We've received your booking request. You'll receive a confirmation via WhatsApp and email shortly.</p>
                            <div class="booking-ref">
                                <div class="ref-label">Booking Reference</div>
                                <div class="ref-number" id="bookingRef">MJS-2026-XXXXX</div>
                            </div>
                            <p style="font-size:0.85rem;">Questions? Contact us on <a href="https://api.whatsapp.com/send?phone=34655442232" target="_blank" rel="noopener noreferrer" style="color:var(--primary);font-weight:600;">WhatsApp</a> or call <a href="tel:+34655442232" style="color:var(--primary);font-weight:600;">+34 655 442 232</a></p>
                            <div style="margin-top:30px;">
                                <a href="index.html" class="btn-next" style="display:inline-block;text-decoration:none;">
                                    <i class="fas fa-home"></i> Back to Home
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Order Summary Sidebar -->
                <div class="order-summary" id="orderSummary">
                    <h4><i class="fas fa-receipt"></i> Booking Summary</h4>
                    
                    <div class="summary-row">
                        <span class="label">Activity</span>
                        <span class="value" id="sumActivity">—</span>
                    </div>
                    <div class="summary-row">
                        <span class="label">Duration</span>
                        <span class="value" id="sumDuration">—</span>
                    </div>
                    <div class="summary-row">
                        <span class="label">Date</span>
                        <span class="value" id="sumDate">—</span>
                    </div>
                    <div class="summary-row">
                        <span class="label">Time</span>
                        <span class="value" id="sumTime">—</span>
                    </div>
                    <div class="summary-row">
                        <span class="label">Guests</span>
                        <span class="value" id="sumGuests">—</span>
                    </div>
                    
                    <div class="summary-divider"></div>
                    
                    <div class="summary-row">
                        <span class="label">Unit Price</span>
                        <span class="value" id="sumUnitPrice">—</span>
                    </div>
                    <div class="summary-row" id="sumQtyRow" style="display:none;">
                        <span class="label">Quantity</span>
                        <span class="value" id="sumQty">—</span>
                    </div>
                    
                    <div class="summary-divider"></div>
                    
                    <div class="summary-total">
                        <span>Total</span>
                        <span class="total-price" id="sumTotal">€0</span>
                    </div>
                    <p style="text-align:center;font-size:0.78rem;color:var(--text-secondary);margin-top:6px;"><i class="fas fa-receipt" style="margin-right:4px;color:var(--primary);opacity:0.7;"></i>All prices include VAT (IVA)</p>

                    <div class="summary-badges">
                        <div class="summary-badge"><i class="fas fa-check-circle"></i> Free cancellation (24h notice)</div>
                        <div class="summary-badge"><i class="fas fa-check-circle"></i> Full weather refund guarantee</div>
                        <div class="summary-badge"><i class="fas fa-check-circle"></i> Safety equipment included</div>
                        <div class="summary-badge"><i class="fas fa-check-circle"></i> Photos & videos included</div>
                        <div class="summary-badge"><i class="fas fa-check-circle"></i> Civil liability insurance</div>
                    </div>

                    <a href="https://api.whatsapp.com/send?phone=34655442232&text=Hi!%20I%27d%20like%20to%20book%20a%20water%20sports%20experience!" target="_blank" rel="noopener noreferrer" class="summary-whatsapp">
                        <i class="fab fa-whatsapp"></i> Or book via WhatsApp
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Policies Bar -->
    <section class="policies-bar">
        <div class="container">
            <div class="policies-grid">
                <div class="policy-item">
                    <i class="fas fa-undo"></i>
                    <h5>Free Cancellation</h5>
                    <p>Cancel 24h before for a full refund</p>
                </div>
                <div class="policy-item">
                    <i class="fas fa-cloud-sun-rain"></i>
                    <h5>Weather Guarantee</h5>
                    <p>100% refund if cancelled due to weather</p>
                </div>
                <div class="policy-item">
                    <i class="fas fa-lock"></i>
                    <h5>Secure Payment</h5>
                    <p>256-bit SSL encrypted transactions</p>
                </div>
                <div class="policy-item">
                    <i class="fas fa-shield-alt"></i>
                    <h5>Fully Insured</h5>
                    <p>Civil liability insurance on all activities</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-wave">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320">
                <path fill="#03045e" fill-opacity="1" d="M0,96L48,112C96,128,192,160,288,160C384,160,480,128,576,122.7C672,117,768,139,864,154.7C960,171,1056,181,1152,165.3C1248,149,1344,107,1392,85.3L1440,64L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path>
            </svg>
        </div>
        <div class="footer-content">
            <div class="container">
                <div class="footer-grid">
                    <div class="footer-brand">
                        <a href="index.html" class="footer-logo">
                            <img src="https://marbellajetski.com/wp-content/uploads/2021/05/MJS_16_500x500-removebg-preview.png" alt="Marbella JetSki Logo" style="height: 60px; margin-bottom: 15px;">
                            <span class="logo-text">MARBELLA<span class="logo-highlight">JETSKI</span></span>
                        </a>
                        <p>Costa del Sol's premier water sports destination. Family-owned since 1998, led by 4x Spanish National Champion Daniel Stiers.</p>
                    </div>
                    <div class="footer-links">
                        <h4>Quick Links</h4>
                        <ul>
                            <li><a href="index.html#services">Services</a></li>
                            <li><a href="index.html#jetski">Jet Ski Hire</a></li>
                            <li><a href="index.html#watersports">Water Sports</a></li>
                            <li><a href="index.html#boats">Yacht Charters</a></li>
                            <li><a href="about-daniel.html">Lessons</a></li>
                        </ul>
                    </div>
                    <div class="footer-links">
                        <h4>Legal</h4>
                        <ul>
                            <li><a href="terms.html#legal-notice">Legal Notice</a></li>
                            <li><a href="terms.html#terms">Terms & Conditions</a></li>
                            <li><a href="terms.html#privacy">Privacy Policy</a></li>
                            <li><a href="terms.html#cancellation">Cancellation Policy</a></li>
                            <li><a href="weather-policy.html">Weather Protocol</a></li>
                            <li><a href="terms.html#cookies">Cookie Policy</a></li>
                        </ul>
                    </div>
                    <div class="footer-contact">
                        <h4>Contact</h4>
                        <div class="footer-contact-item"><i class="fas fa-phone-alt"></i> <a href="tel:+34655442232">+34 655 442 232</a></div>
                        <div class="footer-contact-item"><i class="fab fa-whatsapp"></i> <a href="https://api.whatsapp.com/send?phone=34655442232" target="_blank" rel="noopener noreferrer">WhatsApp</a></div>
                        <div class="footer-contact-item"><i class="fas fa-envelope"></i> <a href="mailto:jetskimarbella@gmail.com">jetskimarbella@gmail.com</a></div>
                        <div class="footer-contact-item"><i class="fas fa-clock"></i> <span>Daily: 11am - 8pm</span></div>
                        
                        <div class="footer-social">
                            <a href="https://www.facebook.com/jetskimarbella/" target="_blank" rel="noopener noreferrer" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                            <a href="https://www.instagram.com/jetskimarbella/" target="_blank" rel="noopener noreferrer" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                            <a href="https://www.tripadvisor.es/Attraction_Review-g187439-d6949698-Reviews-Marbella_Jet_Ski-Marbella_Costa_del_Sol_Province_of_Malaga_Andalucia.html" target="_blank" rel="noopener noreferrer" aria-label="TripAdvisor"><i class="fab fa-tripadvisor"></i></a>
                        </div>
                    </div>
                </div>
                <div class="footer-bottom">
                    <p>&copy; 2026 STIERS E HIJOS S.L. (Marbella JetSki). All rights reserved. NIF: B92917178</p>
                    <p class="credit">Designed with 💙 for Summer 2026</p>
                </div>
            </div>
        </div>
    </footer>

    <script>
    /* ========== Booking System Logic ========== */
    let currentStep = 1;
    let selectedActivity = null;
    let totalPrice = 0;
    let depositType = 'deposit';
    const LANG = 'en';
    const MAX_CIRCUIT_JETSKIS = 4;
    const MIN_TOUR_JETSKIS = 2;
    const MIN_TOWABLE_GUESTS = 2;
    const SAME_DAY_CUTOFF_HOUR = 14;

    // Set min date to today
    document.addEventListener('DOMContentLoaded', function() {
        const today = new Date().toISOString().split('T')[0];
        const dateInput = document.getElementById('bookDate');
        if (dateInput) dateInput.min = today;

        // Category tab filtering
        document.querySelectorAll('.cat-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                document.querySelectorAll('.cat-tab').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                const cat = this.dataset.cat;
                document.querySelectorAll('.activity-option').forEach(opt => {
                    opt.style.display = (cat === 'all' || opt.dataset.cat === cat) ? '' : 'none';
                });
            });
        });

        // Activity selection
        document.querySelectorAll('input[name="activity"]').forEach(radio => {
            radio.addEventListener('change', function() {
                document.querySelectorAll('.activity-option').forEach(o => o.classList.remove('selected'));
                this.closest('.activity-option').classList.add('selected');

                // Show/hide training notice for request-only activities
                const notice = document.getElementById('trainingNotice');
                const stepNav = this.closest('.step-content, .step-panel').querySelector('.step-nav');
                if (this.dataset.type === 'request-only') {
                    if (notice) notice.style.display = 'block';
                    if (stepNav) stepNav.style.display = 'none';
                } else {
                    if (notice) notice.style.display = 'none';
                    if (stepNav) stepNav.style.display = '';
                }

                applyActivityConstraints();
                updateSummary();
            });
        });

        // Guest & jetski count change with validation
        ['bookGuests', 'bookJetskis'].forEach(id => {
            const el = document.getElementById(id);
            if (el) el.addEventListener('change', function() { validateConstraints(); updateSummary(); });
        });

        // Date change — same-day cutoff check
        if (dateInput) {
            dateInput.addEventListener('change', function() {
                checkSameDayCutoff();
                updateSummary();
            });
        }

        // Time change
        const timeEl = document.getElementById('bookTime');
        if (timeEl) timeEl.addEventListener('change', updateSummary);

        // Mobile nav toggle
        const navToggle = document.getElementById('navToggle');
        const navMenu = document.getElementById('navMenu');
        if (navToggle && navMenu) {
            navToggle.addEventListener('click', () => {
                navMenu.classList.toggle('active');
                navToggle.classList.toggle('active');
            });
        }
    });

    function getActivityType() {
        const radio = document.querySelector('input[name="activity"]:checked');
        if (!radio) return null;
        return radio.dataset.type || (radio.value.startsWith('jetski') ? 'circuit' : null);
    }

    function applyActivityConstraints() {
        const radio = document.querySelector('input[name="activity"]:checked');
        if (!radio) return;
        const type = radio.dataset.type || '';
        const jsField = document.getElementById('jetskiCountField');
        const jsInput = document.getElementById('bookJetskis');
        const guestsInput = document.getElementById('bookGuests');

        if (jsField) {
            jsField.style.display = radio.value.startsWith('jetski') ? '' : 'none';
        }

        if (type === 'circuit' && jsInput) {
            jsInput.max = MAX_CIRCUIT_JETSKIS;
            if (parseInt(jsInput.value) > MAX_CIRCUIT_JETSKIS) jsInput.value = MAX_CIRCUIT_JETSKIS;
        }
        if (type === 'tour' && jsInput) {
            jsInput.min = MIN_TOUR_JETSKIS;
            if (parseInt(jsInput.value) < MIN_TOUR_JETSKIS) jsInput.value = MIN_TOUR_JETSKIS;
        } else if (jsInput) {
            jsInput.min = 1;
        }
        if (type === 'sup' && guestsInput) {
            guestsInput.value = 1;
            guestsInput.max = 1;
            guestsInput.disabled = true;
        } else if (guestsInput) {
            guestsInput.max = 12;
            guestsInput.disabled = false;
        }
        if (type === 'towable' && guestsInput) {
            guestsInput.min = MIN_TOWABLE_GUESTS;
            if (parseInt(guestsInput.value) < MIN_TOWABLE_GUESTS) guestsInput.value = MIN_TOWABLE_GUESTS;
        } else if (guestsInput && type !== 'sup') {
            guestsInput.min = 1;
        }
        hideAllValidationMsgs();
    }

    function validateConstraints() {
        const radio = document.querySelector('input[name="activity"]:checked');
        if (!radio) return true;
        const type = radio.dataset.type || '';
        const jsInput = document.getElementById('bookJetskis');
        const guestsInput = document.getElementById('bookGuests');
        let valid = true;
        hideAllValidationMsgs();

        if (type === 'circuit' && jsInput && parseInt(jsInput.value) > MAX_CIRCUIT_JETSKIS) {
            showMsg('maxJetskiMsg');
            jsInput.value = MAX_CIRCUIT_JETSKIS;
            valid = false;
        }
        if (type === 'tour' && jsInput && parseInt(jsInput.value) < MIN_TOUR_JETSKIS) {
            showMsg('minTourMsg');
            valid = false;
        }
        if (type === 'towable' && guestsInput && parseInt(guestsInput.value) < MIN_TOWABLE_GUESTS) {
            showMsg('minTowableMsg');
            valid = false;
        }
        return valid;
    }

    function checkSameDayCutoff() {
        const dateInput = document.getElementById('bookDate');
        const msg = document.getElementById('sameDayMsg');
        const timeSelect = document.getElementById('bookTime');
        if (!dateInput || !msg) return true;

        const today = new Date().toISOString().split('T')[0];
        const now = new Date();
        const currentHour = now.getHours();

        if (dateInput.value === today && currentHour >= SAME_DAY_CUTOFF_HOUR) {
            showMsg('sameDayMsg');
            if (timeSelect) {
                Array.from(timeSelect.options).forEach(opt => {
                    if (opt.value) opt.disabled = true;
                });
                timeSelect.value = '';
            }
            return false;
        } else {
            hideMsg('sameDayMsg');
            if (timeSelect) {
                Array.from(timeSelect.options).forEach(opt => opt.disabled = false);
            }
            return true;
        }
    }

    function showMsg(id) { const el = document.getElementById(id); if (el) el.classList.add('visible'); }
    function hideMsg(id) { const el = document.getElementById(id); if (el) el.classList.remove('visible'); }
    function hideAllValidationMsgs() {
        ['sameDayMsg', 'maxJetskiMsg', 'minTourMsg', 'minTowableMsg'].forEach(id => hideMsg(id));
    }

    function goToStep(step) {
        // Validate current step before advancing
        if (step > currentStep) {
            if (currentStep === 1) {
                const selected = document.querySelector('input[name="activity"]:checked');
                if (!selected) {
                    alert('Please select an activity to continue.');
                    return;
                }
            }
            if (currentStep === 2) {
                const date = document.getElementById('bookDate').value;
                const time = document.getElementById('bookTime').value;
                if (!date || !time) {
                    alert('Please select a date and time.');
                    return;
                }
            }
            if (currentStep === 3) {
                const fname = document.getElementById('bookFirstName').value;
                const lname = document.getElementById('bookLastName').value;
                const email = document.getElementById('bookEmail').value;
                const phone = document.getElementById('bookPhone').value;
                const id = document.getElementById('bookID').value;
                const dob = document.getElementById('bookDOB').value;
                if (!fname || !lname || !email || !phone || !id || !dob) {
                    alert('Please fill in all required fields.');
                    return;
                }
            }
        }

        currentStep = step;
        
        // Update step indicators
        document.querySelectorAll('.step').forEach((s, i) => {
            s.classList.remove('active', 'completed');
            if (i + 1 === step) s.classList.add('active');
            if (i + 1 < step) s.classList.add('completed');
        });

        // Show correct panel
        document.querySelectorAll('.step-panel').forEach(p => p.classList.remove('active'));
        const panel = document.getElementById('step' + step);
        if (panel) panel.classList.add('active');

        // Show/hide jetski count field
        if (step === 2) {
            const activity = document.querySelector('input[name="activity"]:checked');
            const jsField = document.getElementById('jetskiCountField');
            if (activity && jsField) {
                jsField.style.display = activity.value.startsWith('jetski') ? '' : 'none';
            }
        }

        updateSummary();
        window.scrollTo({ top: 200, behavior: 'smooth' });
    }

    function updateSummary() {
        const radio = document.querySelector('input[name="activity"]:checked');
        if (!radio) return;

        const name = radio.dataset.name;
        const duration = radio.dataset.duration;
        const price = parseFloat(radio.dataset.price);
        const perPerson = radio.dataset.per === 'person';
        const guests = parseInt(document.getElementById('bookGuests').value) || 1;
        const jetskis = parseInt(document.getElementById('bookJetskis')?.value) || 1;
        const date = document.getElementById('bookDate').value;
        const time = document.getElementById('bookTime').value;

        // Calculate total
        let qty = 1;
        if (perPerson) {
            qty = guests;
        } else if (radio.value.startsWith('jetski')) {
            qty = jetskis;
        }
        totalPrice = price * qty;

        // Update summary
        document.getElementById('sumActivity').textContent = name;
        document.getElementById('sumDuration').textContent = duration;
        document.getElementById('sumDate').textContent = date ? new Date(date + 'T12:00').toLocaleDateString('en-GB', { day: 'numeric', month: 'short', year: 'numeric' }) : '—';
        document.getElementById('sumTime').textContent = time || '—';
        document.getElementById('sumGuests').textContent = guests;
        document.getElementById('sumUnitPrice').textContent = '€' + price;
        
        if (qty > 1) {
            document.getElementById('sumQtyRow').style.display = '';
            document.getElementById('sumQty').textContent = qty + (perPerson ? ' persons' : ' jet skis');
        } else {
            document.getElementById('sumQtyRow').style.display = 'none';
        }

        document.getElementById('sumTotal').textContent = '€' + totalPrice.toLocaleString();

        // Update deposit amounts
        const deposit = Math.ceil(totalPrice * 0.3);
        document.getElementById('depositAmount').textContent = '€' + deposit;
        document.getElementById('fullAmount').textContent = '€' + totalPrice.toLocaleString();
        
        const payAmount = depositType === 'deposit' ? deposit : totalPrice;
        const payBtn = document.getElementById('payButtonAmount');
        if (payBtn) payBtn.textContent = ' €' + payAmount;
    }

    function selectDeposit(type, ev) {
        depositType = type;
        document.querySelectorAll('.deposit-option').forEach(o => o.classList.remove('selected'));
        if (ev) ev.currentTarget.classList.add('selected');
        updateSummary();
    }

    function selectPayment(type, ev) {
        document.querySelectorAll('.payment-method').forEach(m => m.classList.remove('selected'));
        if (ev) ev.currentTarget.closest('.payment-method').classList.add('selected');
        
        const cardFields = document.getElementById('cardFields');
        cardFields.classList.toggle('visible', type === 'card');
    }

    function submitBooking() {
        const terms = document.getElementById('termsAccept');
        if (!terms.checked) {
            alert('Please accept the Terms & Conditions to continue.');
            return;
        }

        // Generate booking reference
        const ref = 'MJS-' + new Date().getFullYear() + '-' + Math.random().toString(36).substr(2, 5).toUpperCase();
        document.getElementById('bookingRef').textContent = ref;

        // Gather booking data
        const activityEl = document.querySelector('input[name="activity"]:checked');
        const activityName = activityEl ? activityEl.dataset.name : '';
        const activityDuration = activityEl ? activityEl.dataset.duration : '';
        const date = document.getElementById('bookDate').value;
        const time = document.getElementById('bookTime').value;
        const guests = document.getElementById('bookGuests').value;
        const firstName = document.getElementById('bookFirstName').value;
        const lastName = document.getElementById('bookLastName').value;
        const email = document.getElementById('bookEmail').value;
        const phone = document.getElementById('bookPhone').value;
        const payMethod = document.querySelector('input[name="payment"]:checked');
        const payMethodName = payMethod ? payMethod.value : 'not selected';
        const payAmount = depositType === 'deposit' ? Math.ceil(totalPrice * 0.3) : totalPrice;

        // Build WhatsApp message
        const msg = `🏍️ NEW BOOKING REQUEST\n` +
            `Ref: ${ref}\n\n` +
            `Activity: ${activityName} (${activityDuration})\n` +
            `Date: ${date}\n` +
            `Time: ${time}\n` +
            `Guests: ${guests}\n\n` +
            `Name: ${firstName} ${lastName}\n` +
            `Email: ${email}\n` +
            `Phone: ${phone}\n\n` +
            `Payment: ${payMethodName} (${depositType})\n` +
            `Amount: €${payAmount} of €${totalPrice} total\n\n` +
            `Sent from marbellajetski.com booking system`;

        // Show confirmation
        currentStep = 5;
        document.querySelectorAll('.step').forEach(s => s.classList.add('completed'));
        document.querySelectorAll('.step-panel').forEach(p => p.classList.remove('active'));
        document.getElementById('step5').classList.add('active');
        document.getElementById('orderSummary').style.display = 'none';
        
        window.scrollTo({ top: 200, behavior: 'smooth' });

        // Send booking via WhatsApp
        setTimeout(() => {
            window.open(`https://api.whatsapp.com/send?phone=34655442232&text=${encodeURIComponent(msg)}`, '_blank');
        }, 1500);
    }
    </script>
</body>
</html>